# 广理成绩自动化核查程序

一个面向广东理工学院奖学金评选时奖助贷工作人员对成绩核查场景的 Electron 桌面应用，内置 Excel 解析、辅助核查窗口与数据统计，帮助小助理大幅减少重复性操作。

> 作者：神奇小冬天 · 主页：www.iamdt.cn · License：MIT

---

## 🎯 功能亮点

- **智能 Excel 预处理**：内置 13 位学号识别、连续序号检测与中文姓名列推断，上传后即可自动完成列映射。
- **大尺寸数据预览**：独立预览弹窗支持无限滚动、ESC 关闭、列宽自适应，方便核对导入内容。
- **核查工作台**：置顶小窗 + 全局快捷键（默认 `Ctrl + N`，可在设置中自定义）控制流程，自动将学号写入剪贴板，避免来回切换。
- **标记与统计**：一键标记疑似异常条目（支持备注、Ctrl+Enter 快速确认），文件自动落地 `标记记录/` 目录；核查结束提供起止序号、核查数量、标记数量与总耗时。
- **多窗口协同**：支持表格预览窗口（带搜索与行号跳转）、备注窗口、核查窗口之间的联动与高亮同步。
- **浏览器联动扩展**：内置本地 HTTP 通信服务与浏览器扩展，可在教务系统成绩页面自动聚焦、填写学生姓名和学号，并配合“下一行”操作触发自动填写。

---

## 📦 下载与体验

| 发行物 | 说明 |
| ------ | ---- |
| `广理成绩核查 Setup 1.1.0.exe` | 标准安装版（含开始菜单/桌面快捷方式） |
| `广理成绩核查-1.1.0-portable.exe` | 绿色便携版，解压即用 |
| `广理成绩核查助手-扩展.zip` | 浏览器扩展，辅助自动填充姓名/学号并触发查询 |

所有打包产物均位于 `release/` 目录，完整流程参见 [打包说明](./docs/BUILD.md)。

---

## ⚙️ 运行环境

- Windows 10 及以上版本（桌面端运行环境）
- Node.js 16+（本地开发/构建需要）
- npm 8+（建议）

---

## 🚀 快速上手

```bash
# 1. 安装依赖
npm install

# 2. 启动开发环境（Vite + Electron 双进程）
npm run electron:dev

# 3. 生产构建（产物输出到 release/）
npm run electron:build
```

常用脚本速查：

| 命令 | 作用 |
| ---- | ---- |
| `npm run dev` | 纯前端（Vite）调试 |
| `npm run build` | 构建前端静态资源 |
| `npm run build:electron` | 复制主进程与 preload 脚本到 `dist-electron/` |
| `npm run package:extension` | 打包浏览器扩展（输出 zip） |
| `npm run clean` | 清理 `dist/`、`dist-electron/`、`release/` |

---

## 🗂️ 项目结构

```
GradeCheck/
├─ src/                # React + Tailwind 前端页面
│  ├─ pages/           # MainPage、CheckWindow、Settings 等业务页面
│  └─ components/      # TitleBar、共用组件
├─ electron/           # Electron 主进程、preload、扩展通信服务
├─ extension/          # 浏览器扩展源码，可独立加载
├─ scripts/            # 构建辅助脚本（清理、拷贝、扩展打包）
├─ dist/, dist-electron/  # Vite & Electron 构建结果
├─ release/            # electron-builder 输出（安装包、便携版、日志）
├─ docs/               # 详细打包说明等开发文档
└─ README.md           # 项目总览与快速上手
```

---

## 🧭 使用流程

1. **上传 Excel**：点击上传区域或拖拽文件，支持 `.xlsx/.xls`。
2. **检查自动映射**：预览弹窗会自动识别起始行/序号/姓名/学号列，可在右侧配置区域手动校正。
3. **开始核查**：进入核查小窗后，学号会自动复制，按 `Ctrl + →` 或点击 “下一行” 即可推进。
4. **标记异常**：点击 “标记” 将当前行写入 `标记记录/xxxx.txt`，方便复盘与回访。
5. **查看统计**：结束核查后自动跳转至 `EndPage` 展示总耗时、通过率等数据。

> 提示：可通过 “打开标记文件夹” 按钮快速定位输出目录；设置页支持修改置顶行为、自动复制等偏好。

---

## 🌐 浏览器扩展

- 位置：`extension/`
- 功能：与桌面端通过本地服务通信，自动向在线查询系统填充姓名/学号并触发按钮。
- 调试：在 Chrome/Edge 中选择 “加载已解压的扩展程序” 指向该目录；若需分发，执行 `npm run package:extension` 生成 zip。

---

## ❓ 常见问题

- **Electron 启动报错 “Electron API 未加载”**  
  请确保使用 `npm run electron:dev` 或安装包运行，而不是直接打开 `index.html`。

- **Excel 识别列不准确**  
  上传后可在预览弹窗右侧手动调整列号；系统会记住最近一次配置。

- **标记文件存放在哪里？**  
  默认保存在应用同级的 `标记记录/` 文件夹，可通过主界面右上角按钮快捷打开。

---

欢迎有能力，有技术的同学提交 Issue / PR 共同完善本项目 🙌

---

## 📄 License

MIT © 2025 冬天的小窝
